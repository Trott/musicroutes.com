<!DOCTYPE html>
<html>
<head>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
</head>
<body>
  <ol id="results">
  </ol>
<script>
(function () {
  var getContributedTo = function (data) {
    var ol;

    if (data['/music/track_contribution/track'] instanceof Array) {
      ol = $('<ol>');
      $.each(data['/music/track_contribution/track'], function (i, result) {
        if (result.mid) {
          var name = result.name || 'Untitled';
          // TODO: sanitize mid
          var a = $('<a>', {href: 'http://freebase.com' + result.mid, text: name});
          var li = $('<li>');
          a.appendTo(li);
          li.appendTo(ol);
        }
      });
    }

    return ol;
  }


  var service_url = 'https://www.googleapis.com/freebase/v1/search';
  var params = {
    'filter': '(all type:/music/artist)',
    'limit': 222,
    'output': '(/music/track_contribution/track)'
  };
  $.getJSON(service_url + '?callback=?', params, function(response) {
    if (response.error) {
      $('<div>', {text:response.error.message}).appendTo(document.body);
    }
    if (response.result instanceof Array) {
      $.each(response.result, function(i, result) {
        var li = $('<li>', {text:result['name']});

        if (result.output) {
          var contributedTo = getContributedTo(result.output['/music/track_contribution/track']);
          if (contributedTo) {
            contributedTo.appendTo(li);
            li.appendTo($('#results'));
          }
        }
      });
    }
  });
}());
</script>
</body>
</html>